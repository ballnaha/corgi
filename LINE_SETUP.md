# р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ LINE API р╕кр╕│р╕лр╕гр╕▒р╕Ър╕кр╣Ир╕З Flex Message

## р╕Хр╕▒р╕зр╣Бр╕Ыр╕гр╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╣Гр╕Щ .env.local

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М `.env.local` р╣Гр╕Щр╕гр╕╣р╕Ч directory р╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╣Зр╕Д:

```bash
# Database
DATABASE_URL="mysql://root:@localhost:3306/corgi"

# NextAuth
NEXTAUTH_SECRET="your-secret-key-for-development"
NEXTAUTH_URL="http://localhost:3000"

# LINE OAuth (р╕кр╕│р╕лр╕гр╕▒р╕Ъ login р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й)
LINE_CLIENT_ID="your-line-client-id"
LINE_CLIENT_SECRET="your-line-client-secret"

# LINE Messaging API (р╕кр╕│р╕лр╕гр╕▒р╕Ър╕кр╣Ир╕З message)
LINE_CHANNEL_ACCESS_TOKEN="your-line-channel-access-token"
LINE_CHANNEL_SECRET="your-line-channel-secret"

# Application
NODE_ENV="development"
```

тЪая╕П **р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕**: р╕лр╕▓р╕Бр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ `LINE_CHANNEL_ACCESS_TOKEN` р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕вр╕▒р╕Зр╕Др╕Зр╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Йр╕Ыр╕Бр╕Хр╕┤ р╣Бр╕Хр╣Ир╕Ир╕░р╣Др╕бр╣Ир╕кр╣Ир╕З LINE message р╣Бр╕ер╕░р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б "р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕кр╕│р╣Ар╕гр╣Зр╕И! (LINE messaging р╕вр╕▒р╕Зр╣Др╕бр╣Ир╣Др╕Фр╣Йр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓)"

### р╕зр╕┤р╕Шр╕╡р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env.local

**Windows (PowerShell):**
```powershell
# р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env.local
New-Item -Path ".env.local" -ItemType File

# р╕лр╕гр╕╖р╕нр╣Гр╕Кр╣Й echo р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╕Юр╕гр╣Йр╕нр╕бр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕Хр╣Йр╕Щ
echo "DATABASE_URL=`"mysql://root:@localhost:3306/corgi`"" > .env.local
echo "NEXTAUTH_SECRET=`"your-secret-key-for-development`"" >> .env.local
echo "NEXTAUTH_URL=`"http://localhost:3000`"" >> .env.local
echo "LINE_CHANNEL_ACCESS_TOKEN=`"`"" >> .env.local
```

**р╕лр╕гр╕╖р╕нр╕кр╕гр╣Йр╕▓р╕Зр╕Фр╣Йр╕зр╕вр╕бр╕╖р╕н:**
1. р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╣Гр╕лр╕бр╣Ир╕Кр╕╖р╣Ир╕н `.env.local` р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕лр╕ер╕▒р╕Бр╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╣Зр╕Д
2. р╕Др╕▒р╕Фр╕ер╕нр╕Бр╣Ар╕Щр╕╖р╣Йр╕нр╕лр╕▓р╕Вр╣Йр╕▓р╕Зр╕Ър╕Щр╣Гр╕кр╣Ир╣Гр╕Щр╣Др╕Яр╕ер╣М
3. р╣Гр╕кр╣Ир╕Др╣Ир╕▓р╕Ир╕гр╕┤р╕Зр╕Вр╕нр╕З LINE tokens

## р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓

### 1. р╕кр╕гр╣Йр╕▓р╕З LINE Messaging API Channel

1. р╣Др╕Ыр╕Чр╕╡р╣И [LINE Developers Console](https://developers.line.biz/)
2. р╕кр╕гр╣Йр╕▓р╕З Provider р╣Гр╕лр╕бр╣Ир╕лр╕гр╕╖р╕нр╣Ар╕ер╕╖р╕нр╕Б Provider р╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣И
3. р╕кр╕гр╣Йр╕▓р╕З Channel р╣Гр╕лр╕бр╣Ир╕Ыр╕гр╕░р╣Ар╕ар╕Ч "Messaging API"
4. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Кр╕╖р╣Ир╕н Channel р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕╖р╣Ир╕Щр╣Ж

### 2. р╕гр╕▒р╕Ъ Channel Access Token

1. р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Channel Settings
2. р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ "Messaging API"
3. р╕кр╕гр╣Йр╕▓р╕З Channel Access Token
4. р╕Др╕▒р╕Фр╕ер╕нр╕Бр╣Бр╕ер╕░р╣Ар╕Бр╣Зр╕Ъ Token р╕Щр╕╡р╣Йр╣Гр╕кр╣Ир╣Гр╕Щ `LINE_CHANNEL_ACCESS_TOKEN`

### 3. р╕гр╕▒р╕Ъ Channel Secret

1. р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Channel Settings
2. р╣Др╕Ыр╕Чр╕╡р╣Ир╣Бр╕Чр╣Зр╕Ъ "Basic Settings"
3. р╕Др╕▒р╕Фр╕ер╕нр╕Б Channel Secret
4. р╣Ар╕Бр╣Зр╕Ъ Secret р╕Щр╕╡р╣Йр╣Гр╕кр╣Ир╣Гр╕Щ `LINE_CHANNEL_SECRET`

### 4. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook (р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г)

1. р╣Гр╕Щр╣Бр╕Чр╣Зр╕Ъ "Messaging API"
2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook URL: `https://yourdomain.com/api/webhooks/line`
3. р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ Webhook

## р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╕гр╕░р╕Ър╕Ъ

### р╣Ар╕бр╕╖р╣Ир╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓:

1. тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕нр╕Ир╕░р╕Цр╕╣р╕Бр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е
2. тЬЕ р╕кр╕гр╣Йр╕▓р╕З Flex Message р╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕Ър╣Ар╕кр╕гр╣Зр╕И
3. тЬЕ р╕кр╣Ир╕З Message р╣Др╕Ыр╕вр╕▒р╕З LINE р╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
4. тЬЕ р╣Бр╕кр╕Фр╕Зр╕Бр╕▓р╕гр╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕зр╣Ир╕▓р╕кр╣Ир╕Зр╕кр╕│р╣Ар╕гр╣Зр╕Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И

### р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Гр╕Ър╣Ар╕кр╕гр╣Зр╕И Flex Message:

- ЁЯР╛ Header р╕Вр╕нр╕Зр╕гр╣Йр╕▓р╕Щ
- ЁЯУД р╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н
- ЁЯСд р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╣р╕Бр╕Др╣Йр╕▓
- ЁЯЫНя╕П р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
- ЁЯТ░ р╕кр╕гр╕╕р╕Ыр╕гр╕▓р╕Др╕▓ (р╕гр╕зр╕бр╕кр╣Ир╕зр╕Щр╕ер╕Ф/р╕Др╣Ир╕▓р╕Ир╕▒р╕Фр╕кр╣Ир╕З)
- ЁЯУж р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕кр╣Ир╕З
- тП░ р╕зр╕▒р╕Щр╕Чр╕╡р╣И/р╣Ар╕зр╕ер╕▓р╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н

### р╕Бр╕гр╕Ур╕╡р╕Кр╕│р╕гр╕░р╕бр╕▒р╕Фр╕Ир╕│:

- р╣Бр╕кр╕Фр╕Зр╕вр╕нр╕Фр╕бр╕▒р╕Фр╕Ир╕│р╕Чр╕╡р╣Ир╕Кр╕│р╕гр╕░ (20%)
- р╣Бр╕кр╕Фр╕Зр╕вр╕нр╕Фр╕Др╕Зр╣Ар╕лр╕ер╕╖р╕нр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Кр╕│р╕гр╕░р╣Ар╕бр╕╖р╣Ир╕нр╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓
- р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕гр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕Фр╣Йр╕зр╕вр╕Хр╕▒р╕зр╣Ар╕нр╕З

## р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ

1. р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕в LINE
2. р╣Ар╕Юр╕┤р╣Ир╕бр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕ер╕Зр╕Хр╕░р╕Бр╕гр╣Йр╕▓
3. р╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╕Щр╣Йр╕▓ Checkout
4. р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╕Бр╕Фр╕кр╕▒р╣Ир╕Зр╕Лр╕╖р╣Йр╕н
5. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ LINE р╕зр╣Ир╕▓р╣Др╕Фр╣Йр╕гр╕▒р╕Ъ Flex Message р╕лр╕гр╕╖р╕нр╣Др╕бр╣И

## р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- р╕Хр╣Йр╕нр╕Зр╕бр╕╡ LINE_CHANNEL_ACCESS_TOKEN р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Ир╕З message р╣Др╕Фр╣Й
- р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Хр╣Йр╕нр╕З login р╕Фр╣Йр╕зр╕в LINE р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕гр╕░р╕Ър╕Ър╕Чр╕гр╕▓р╕Ъ LINE User ID
- Flex Message р╕Ир╕░р╕кр╣Ир╕Зр╣Др╕Ыр╕вр╕▒р╕З LINE User ID р╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕Ир╕▓р╕Б session
